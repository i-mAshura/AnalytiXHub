# ğŸ—ï¸ OPENCHAIN IR v4.0 - System Architecture

## System Overview Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WEB INTERFACE (Flask)                         â”‚
â”‚  http://localhost:5000                                           â”‚
â”‚  - Dashboard    - Case Manager    - Reports    - Real-time View  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                    â”‚                    â”‚
        â–¼                    â–¼                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Task  â”‚          â”‚ Web    â”‚          â”‚WebSocketâ”‚
    â”‚ Queue  â”‚          â”‚Routes  â”‚          â”‚Updates â”‚
    â”‚(Celery)â”‚          â”‚(Flask) â”‚          â”‚(Real-  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚time)   â”‚
        â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
    â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                              â”‚
    â–¼                                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Cache Layer    â”‚                    â”‚   Analysis       â”‚
â”‚   (Redis)        â”‚                    â”‚   Modules        â”‚
â”‚                  â”‚                    â”‚                  â”‚
â”‚- Session store   â”‚                    â”‚- Multi-chain     â”‚
â”‚- Job results     â”‚                    â”‚- Clustering      â”‚
â”‚- Rate limiting   â”‚                    â”‚- Taint analysis  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚- Smart contracts â”‚
                                        â”‚- DeFi tracker    â”‚
                                        â”‚- Threat intel    â”‚
                                        â”‚- ML anomaly      â”‚
                                        â”‚- Real-time mon   â”‚
                                        â”‚- Batch processor â”‚
                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                        â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚                    â”‚                   â”‚
        â–¼                    â–¼                   â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚              PostgreSQL Database                â”‚
    â”‚                                                 â”‚
    â”‚  Tables:                                        â”‚
    â”‚  - cases           - smart_contracts            â”‚
    â”‚  - addresses       - defi_activity              â”‚
    â”‚  - transactions    - taint_traces               â”‚
    â”‚  - address_clusters - threat_intel              â”‚
    â”‚  - alerts          - anomaly_detection          â”‚
    â”‚  - monitoring_jobs - batch_jobs                 â”‚
    â”‚  - chains                                       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ 20+ indexes for performance
        â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                 â”‚
    â”‚  Connections to External APIs:                  â”‚
    â”‚                                                 â”‚
    â”‚  Blockchain Data:                               â”‚
    â”‚  â€¢ Etherscan API (Ethereum) â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
    â”‚  â€¢ BlockScout API (EVM chains) â”€â”€â”€â”€â”€â”€â”¤           â”‚
    â”‚  â€¢ blockchain.com (Bitcoin/Litecoin) â”œâ”€â”        â”‚
    â”‚  â€¢ XRPL Public Nodes (XRP) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚        â”‚
    â”‚                                       â”‚ â”‚        â”‚
    â”‚  Smart Contract Data:                 â”‚ â”‚        â”‚
    â”‚  â€¢ Etherscan Source Code â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚        â”‚
    â”‚  â€¢ Contract ABI â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚        â”‚
    â”‚                                       â”‚ â”‚        â”‚
    â”‚  DeFi Data:                           â”‚ â”‚        â”‚
    â”‚  â€¢ The Graph (Uniswap V3) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚        â”‚
    â”‚  â€¢ The Graph (Aave) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚        â”‚
    â”‚  â€¢ The Graph (Curve) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚        â”‚
    â”‚                                       â”‚ â”‚        â”‚
    â”‚  Threat Intelligence:                 â”‚ â”‚        â”‚
    â”‚  â€¢ OFAC List (US Treasury) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚        â”‚
    â”‚  â€¢ Etherscan Phishing DB â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚        â”‚
    â”‚  â€¢ SlowMist Evil Addresses â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚        â”‚
    â”‚  â€¢ [Optional] Chainalysis â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚        â”‚
    â”‚  â€¢ [Optional] TRM Labs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚        â”‚
    â”‚                                       â”‚ â”‚        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â”‚ â”‚
                                            â–¼ â–¼
                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                        â”‚ INTERNETâ”‚
                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow Architecture

```
USER INVESTIGATION
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Input Address(es)   â”‚
â”‚  - Single address    â”‚
â”‚  - CSV batch         â”‚
â”‚  - Monitoring watch  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
        â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â”‚
        â–¼     â–¼     â–¼     â–¼     â–¼     â–¼     â–¼     â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚          Multi-Chain Data Fetching             â”‚
    â”‚                                                â”‚
    â”‚  â€¢ Fetch from 10+ blockchains in parallel     â”‚
    â”‚  â€¢ Collect transactions, balances, tokens     â”‚
    â”‚  â€¢ Handle rate limits with backoff            â”‚
    â”‚  â€¢ Cache results in Redis                     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚       Transaction Analysis & Enrichment        â”‚
    â”‚                                                â”‚
    â”‚  â€¢ Normalize data from different chains       â”‚
    â”‚  â€¢ Identify transaction patterns              â”‚
    â”‚  â€¢ Classify by type (swap, transfer, etc)     â”‚
    â”‚  â€¢ Detect anomalies (ML)                      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚        â”‚        â”‚        â”‚        â”‚        â”‚
        â–¼        â–¼        â–¼        â–¼        â–¼        â–¼
    â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”
    â”‚Taint â”‚ â”‚Smart â”‚ â”‚Address â”‚ â”‚DeFi   â”‚ â”‚Riskâ”‚ â”‚Threatâ”‚
    â”‚Track â”‚ â”‚Contractâ”‚Cluster â”‚ â”‚Track  â”‚ â”‚Scoreâ”‚ â”‚Intel â”‚
    â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜
        â”‚        â”‚        â”‚        â”‚        â”‚        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚      Store in PostgreSQL Database              â”‚
    â”‚                                                â”‚
    â”‚  â€¢ All raw transactions                        â”‚
    â”‚  â€¢ Enriched analysis results                   â”‚
    â”‚  â€¢ Risk scores & flags                         â”‚
    â”‚  â€¢ Cluster memberships                         â”‚
    â”‚  â€¢ Fund traces & paths                         â”‚
    â”‚  â€¢ Alert records                               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    Real-Time Monitoring (if enabled)          â”‚
    â”‚                                                â”‚
    â”‚  â€¢ Scheduled checks every 60 seconds           â”‚
    â”‚  â€¢ Detect new transactions                     â”‚
    â”‚  â€¢ Trigger anomaly detection                   â”‚
    â”‚  â€¢ Generate alerts                             â”‚
    â”‚  â€¢ Push updates to dashboard (WebSocket)       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚       Report Generation & Export               â”‚
    â”‚                                                â”‚
    â”‚  â€¢ PDF forensic reports                        â”‚
    â”‚  â€¢ Network graphs (Gephi format)               â”‚
    â”‚  â€¢ CSV data export                             â”‚
    â”‚  â€¢ JSON summaries                              â”‚
    â”‚  â€¢ Charts & visualizations                     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Case Dashboard  â”‚
    â”‚  - All findings  â”‚
    â”‚  - Alerts        â”‚
    â”‚  - Reports       â”‚
    â”‚  - Live updates  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Module Dependency Graph

```
app.py (Flask)
    â”‚
    â”œâ”€â”€ analyzer.py (Core analysis)
    â”‚   â””â”€â”€ db_models.py (Database)
    â”‚       â””â”€â”€ PostgreSQL
    â”‚
    â”œâ”€â”€ multi_chain.py (10+ chains)
    â”‚   â”œâ”€â”€ eth_live.py
    â”‚   â”œâ”€â”€ BlockScout API
    â”‚   â””â”€â”€ blockchain.com API
    â”‚
    â”œâ”€â”€ advanced_analysis.py (Clustering + Anomaly)
    â”‚   â”œâ”€â”€ sklearn (ML)
    â”‚   â””â”€â”€ db_models.py
    â”‚
    â”œâ”€â”€ taint_analysis.py (Fund tracing)
    â”‚   â”œâ”€â”€ networkx (Graph)
    â”‚   â””â”€â”€ db_models.py
    â”‚
    â”œâ”€â”€ smart_contract_analyzer.py (Contract security)
    â”‚   â”œâ”€â”€ Etherscan API
    â”‚   â”œâ”€â”€ regex patterns
    â”‚   â””â”€â”€ db_models.py
    â”‚
    â”œâ”€â”€ defi_analyzer.py (DeFi tracking)
    â”‚   â”œâ”€â”€ The Graph API
    â”‚   â””â”€â”€ db_models.py
    â”‚
    â”œâ”€â”€ threat_intelligence.py (Threat databases)
    â”‚   â”œâ”€â”€ OFAC list
    â”‚   â”œâ”€â”€ Etherscan phishing
    â”‚   â”œâ”€â”€ SlowMist evil list
    â”‚   â””â”€â”€ db_models.py
    â”‚
    â”œâ”€â”€ real_time_monitor.py (Real-time monitoring)
    â”‚   â”œâ”€â”€ APScheduler
    â”‚   â”œâ”€â”€ Celery
    â”‚   â”œâ”€â”€ Redis
    â”‚   â””â”€â”€ db_models.py
    â”‚
    â”œâ”€â”€ batch_analyzer.py (Batch processing)
    â”‚   â”œâ”€â”€ Celery workers
    â”‚   â”œâ”€â”€ analyzer.py
    â”‚   â””â”€â”€ db_models.py
    â”‚
    â”œâ”€â”€ report.py (PDF reports)
    â”‚   â”œâ”€â”€ ReportLab
    â”‚   â””â”€â”€ analyzer.py
    â”‚
    â”œâ”€â”€ gemini.py (AI analysis)
    â”‚   â”œâ”€â”€ Google Gemini API
    â”‚   â””â”€â”€ Flask app
    â”‚
    â”œâ”€â”€ case_manager.py (Case tracking)
    â”‚   â””â”€â”€ db_models.py
    â”‚
    â”œâ”€â”€ legal_report.py (Legal reports)
    â”‚   â”œâ”€â”€ ReportLab
    â”‚   â””â”€â”€ analyzer.py
    â”‚
    â””â”€â”€ visualizations.py (Charts)
        â”œâ”€â”€ Plotly
        â”œâ”€â”€ NetworkX
        â””â”€â”€ analyzer.py
```

## Request Processing Flow

```
HTTP Request (User)
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Flask Route Handler     â”‚  (app.py)
â”‚  - GET/POST processing   â”‚
â”‚  - Input validation      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”œâ”€â”€â”€ SINGLE ADDRESS ANALYSIS â”€â”€â”€â”
    â”‚                               â”‚
    â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Fetch Transactions  â”‚    â”‚  Check Cache    â”‚
â”‚ (Multi-chain)       â”‚    â”‚  (Redis)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                           â”‚
    â–¼                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Analyze Transactions            â”‚
â”‚  - Patterns                      â”‚
â”‚  - Risk score                    â”‚
â”‚  - Clustering                    â”‚
â”‚  - Taint analysis                â”‚
â”‚  - Smart contract checks         â”‚
â”‚  - DeFi tracking                 â”‚
â”‚  - Threat intelligence           â”‚
â”‚  - Anomalies                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Store Results in Database       â”‚
â”‚  - Transactions                  â”‚
â”‚  - Analysis results              â”‚
â”‚  - Alerts                        â”‚
â”‚  - Scores & flags                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Generate Response               â”‚
â”‚  - JSON for API                  â”‚
â”‚  - HTML for web interface        â”‚
â”‚  - PDF report option             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
  HTTP Response (User)

---

BATCH PROCESSING:
    â”‚
    â”œâ”€â”€â”€ Celery Task Queue â”€â”€â”€â”
    â”‚                         â”‚
    â–¼                         â–¼
Submitted to       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
Task Queue         â”‚ Worker Process   â”‚
    â”‚              â”‚ - Analyze each   â”‚
    â”‚              â”‚ - Update progressâ”‚
    â”‚              â”‚ - Store results  â”‚
    â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                      â”‚
    â–¼                      â–¼
User polls for      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
progress            â”‚ Results Storage  â”‚
                    â”‚ (Database)       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                    Return to user
```

## Real-Time Monitoring Flow

```
User enables monitoring for address
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Create MonitoringJob     â”‚
â”‚ - Address                â”‚
â”‚ - Chain                  â”‚
â”‚ - Alert settings         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Schedule Periodic Check  â”‚
â”‚ (APScheduler)            â”‚
â”‚ Every 60 seconds         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”œâ”€â”€â”€ Every 60 seconds â”€â”€â”€â”€â”
    â”‚                         â”‚
    â–¼                         â–¼
Fetch latest        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
transactions        â”‚ Compare with     â”‚
(from API)          â”‚ Previous state   â”‚
    â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                      â”‚
    â–¼                      â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Detect Changes   â”‚
              â”‚ - New txs?       â”‚
              â”‚ - Anomalies?     â”‚
              â”‚ - New parties?   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Generate Alerts  â”‚
              â”‚ (if configured)  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Push Update to   â”‚
              â”‚ Dashboard        â”‚
              â”‚ (WebSocket)      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ User sees alerts    â”‚
          â”‚ in real-time        â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Deployment Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Production Deployment                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                         â”‚
        â–¼                                         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Frontend  â”‚                      â”‚   Backend    â”‚
    â”‚             â”‚                      â”‚              â”‚
    â”‚ HTML/CSS/JS â”‚                      â”‚ Flask + App  â”‚
    â”‚ (Static)    â”‚                      â”‚ Celery       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                                    â”‚
            â”‚                                    â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚           â”‚
                        â–¼           â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Nginx/Apache     â”‚
                    â”‚ (Web Server)     â”‚
                    â”‚ (Load Balancer)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚           â”‚           â”‚
            â–¼           â–¼           â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Redis â”‚  â”‚  PG   â”‚  â”‚PG Rep â”‚
        â”‚ Cache â”‚  â”‚Master â”‚  â”‚Slave  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚           â”‚           â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                       â”‚
         Local                  Remote
      (Docker/VM)           (Cloud/Backup)
```

---

## Component Details

### Frontend Layer
- HTML templates (Jinja2)
- CSS styling
- JavaScript for interactivity
- Bootstrap for responsive design
- Chart.js / Plotly for visualizations

### API Layer
- Flask REST endpoints
- Input validation & rate limiting
- Authentication/Authorization (optional)
- CORS headers for cross-origin
- API documentation

### Business Logic Layer
- Address analysis
- Pattern detection
- Risk scoring
- Clustering algorithms
- Taint analysis
- Smart contract analysis
- DeFi tracking
- Threat intelligence
- Anomaly detection

### Data Layer
- PostgreSQL database
- Redis cache
- Connection pooling
- Query optimization
- Backup/replication ready

### External APIs
- Blockchain: 10+ chains via 3-4 providers
- Smart Contracts: Etherscan verified code
- DeFi: The Graph protocol subgraphs
- Threat Intel: OFAC, Etherscan, SlowMist, etc.

---

This architecture is designed for:
- âœ… **Scalability**: Horizontal scaling with load balancing
- âœ… **Performance**: Caching, indexing, and async processing
- âœ… **Reliability**: Multiple data sources, fallbacks, retries
- âœ… **Maintainability**: Modular design, separation of concerns
- âœ… **Security**: API key management, input validation, rate limiting
